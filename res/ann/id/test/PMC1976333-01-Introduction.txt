Introduction 
Structured microbial habitats have selected for a dazzling diversity of bacterial behaviors. These behaviors are contingent on sophisticated sensory systems that maximize fitness in the complex and highly dynamic environments where physical, chemical, and biological parameters change on many different time scales. Modern genetic and molecular studies have largely focused on a limited repertoire of behaviors of a few model organisms in the non-native context of the laboratory. However, even at the level of basic phenomenology, the vast majority of phenotypes in the microbial biosphere remain uncharacterized. A major challenge of the post-genome era is the development of efficient and comprehensive methods for revealing the genetic basis of these behaviors across diverse clades, especially as the emerging field of metagenomics begins to reveal the wide assortment of microbial life on the planet [1]. Chemotaxis, the capacity to move up and down chemical gradients, is widespread in the bacterial world. An impressive achievement of 20th-century biology was a systems-level understanding of bacterial chemotaxis in terms of the structures, interactions, and organization of the roughly 50 constituent molecular components [2-4]. The best-characterized chemotaxis machineries are those of E. coli and its close relative Salmonella enterica [5,6]. These species propel themselves by rotating multiple extracellular helical filaments called flagella. When the filament rotates in the counterclockwise (CCW) direction, as viewed from outside the cell, a helical wave travels down the filament away from the cell body. In this CCW mode, multiple rotating flagella come together to form a bundle, propelling the cell forward in a motion called "smooth swimming." When one or more motors reverse to the clockwise (CW) direction, the bundle comes apart and the cell "tumbles" briefly, reorienting the cell in a new direction; subsequent motor switching to the CCW direction causes the cell to swim forward again. The direction of rotation is influenced by the output of the chemotaxis network, which consists of a signal transduction cascade that allows robust adaptation to local concentrations of ligands over many orders of magnitude [7,8]. When cells detect an increase in the concentration of an attractant, tumbling is suppressed so as to allow cells to migrate towards the source through the statistical strategy of a biased random walk [9]. The signaling circuit that mediates this behavior terminates at the flagellar machinery, which is synthesized through a sequential hierarchy of gene activation events [10] initiated by the expression of the master transcriptional regulator FlhDC. These events yield an orderly "just-in-time" expression and assembly of the flagellar components [11], which consist of a basal body complex and a filament. The basal body complex contains a central rod that connects the motor to the filament through a short hook. The identification of the molecular components and their organization into the two dominant modules-the chemotaxis network and the flagellum/basal body/motor system-took the better part of 40 years and the work of dozens of laboratories. These efforts have culminated in a level of understanding nearly unmatched in any other domain of molecular biology. For these reasons, flagellar-mediated motility is an ideal test case for any modern post-genomic approach that attempts to efficiently and comprehensively reveal the genetic basis of a complex bacterial phenotype. In this study, we make improvements on a microarray-based genetic footprinting strategy [12], increasing its sensitivity and specificity in revealing the contribution of each and every gene in the genome to a phenotype of interest. We demonstrate the manner in which this strategy can be used to explore the genetic basis of complex bacterial behavior by following the population dynamics of E. coli insertional mutants in environments where reproductive fitness is coupled to motility. To fully identify the genetic determinants for this phenotype, a library of transposon-mutagenized cells was functionally enriched en masse for impaired swimming and surface-mediated swarming motility. We also selected for resistance to bacteriophage chi, which is known to infect and lyse cells only when they are motile. Additionally, we identified the genetic basis of motility suppression by environmental factors. Using DNA microarray hybridization, we monitored the relative abundance of each mutant throughout the selections. The comprehensive nature of our methodology is reflected by the identification of nearly all of the known structural and regulatory components of flagellar-mediated chemotaxis. Strikingly, we also identify dozens of additional loci that contribute to this phenotype. Further characterization of these novel genes revealed that they impair motility through diverse mechanisms such as disrupting signaling through phosphorelay cascades, altering concentrations of the recently appreciated cyclic di-GMP (c-di-GMP) second messenger, and by mechanisms that have yet to be revealed. Subsequent genome-wide epistasis analyses allow us to organize the discovered loci into signaling and regulatory pathways. This systematic framework for genetic characterization can be applied to any microorganism that is amenable to transposon mutagenesis, making it accessible to the vast majority of bacterial systems of importance to basic, industrial, environmental, and clinical research.
